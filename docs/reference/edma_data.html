<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Functions for EDMA data objects — edma_data • EDMAinR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Functions for EDMA data objects — edma_data" />
<meta property="og:description" content="Functions for reading, simulating, and manipulating EDMA data." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-55877016-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-55877016-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EDMAinR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/edma01-data.html">EDMA data</a>
    </li>
    <li>
      <a href="../articles/edma02-form.html">EDMA form matrix</a>
    </li>
    <li>
      <a href="../articles/edma03-parametric.html">Parametric estimation</a>
    </li>
    <li>
      <a href="../articles/edma04-form-difference.html">EDMA form difference matrix</a>
    </li>
    <li>
      <a href="../articles/edma05-growth.html">EDMA growth matrix</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Functions for EDMA data objects</h1>
    
    <div class="hidden name"><code>edma_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions for reading, simulating, and manipulating EDMA data.</p>
    </div>

    <pre class="usage">## read xyz files
read_xyz(file, ...)

## write xyz files
write_xyz(x, file)

## data generation
edma_simulate_data(n, M, SigmaK)

## print
# S3 method for edma_data
print(x, truncate=40, ...)

## accessors
# S3 method for edma_data
dim(x)
# S3 method for edma_data
dimnames(x)
landmarks(x, ...)
dimensions(x, ...)
specimens(x, ...)
# S3 method for edma_data
landmarks(x, ...)
# S3 method for edma_data
dimensions(x, ...)
# S3 method for edma_data
specimens(x, ...)
landmarks(x) &lt;- value
dimensions(x) &lt;- value
specimens(x) &lt;- value

## subsetting
# S3 method for edma_data
subset(x, subset, ...)
# S3 method for edma_data
[(x, i, j, k)

## coercion
# S3 method for edma_data
stack(x, ...)
# S3 method for edma_data
as.matrix(x, ...)
# S3 method for edma_data
as.data.frame(x, ...)
# S3 method for edma_data
as.array(x, ...)
as.edma_data(x, ...)
# S3 method for array
as.edma_data(x, ...)

combine_data(a, b,
    ga="G1", gb="G2")
combine_data4(a1, a2, b1, b2,
    ga1="A1", ga2="A2", gb1="B1", gb2="B2")

## plot methods
plot_2d(x, ...)
plot_ord(x, ...)
plot_clust(x, ...)
# S3 method for edma_data
plot(x, which=NULL,
    ask=dev.interactive(), ...)
# S3 method for edma_data
plot_2d(x, which=NULL, ...)
# S3 method for edma_data
plot_ord(x, ...)
# S3 method for edma_data
plot_clust(x, ...)

## dissimilarities
# S3 method for edma_data
as.dist(m, diag=FALSE, upper=FALSE)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>file</th>
      <td><p>the name of the file which the data are to be read from, or written to,
see <code><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>x, m</th>
      <td><p>an EDMA data object of class 'edma_data'.</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>if a subset of the specimens is required.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>a possible value for <code><a href='https://rdrr.io/r/base/dimnames.html'>dimnames(x)</a></code>.</p></td>
    </tr>
    <tr>
      <th>ask</th>
      <td><p>logical, if <code>TRUE</code>, the user is asked before each plot.</p></td>
    </tr>
    <tr>
      <th>subset, i, j, k</th>
      <td><p>subset is for subsetting specimens (e.g. for bootstrap).
[i, j, k] indices refer to [landmarks, dimensions, specimens].</p></td>
    </tr>
    <tr>
      <th>n, M, SigmaK</th>
      <td><p>number of specimens (n), mean form matrix (M, K x D),
variance-covariance matrix (K x K symmetric).</p></td>
    </tr>
    <tr>
      <th>truncate</th>
      <td><p>numeric, number of characters to print for the object title.</p></td>
    </tr>
    <tr>
      <th>diag, upper</th>
      <td><p>logical, indicating whether the diagonal
and the upper triangle of the distance matrix should be printed.
See <code><a href='https://rdrr.io/r/stats/dist.html'>as.dist</a></code>.</p></td>
    </tr>
    <tr>
      <th>a, b, a1, a2, b1, b2</th>
      <td><p>EDMA data objects to be combined together. Landmarks must be
homologous (determined by dimension names).</p></td>
    </tr>
    <tr>
      <th>ga, gb, ga1, ga2, gb1, gb2</th>
      <td><p>character, group names that are prepended to the specimen names
to differentiate the groups.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments passed to methods.
For <code>read_xyz</code>, arguments passed to <code><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The xyz landmark data has the following structure, see Examples:</p>
<p>- Header: this is the description of the data.</p>
<p>- XYZ: indicates dimensions, XYZ means 3D landmark data.</p>
<p>- <code>42L 3 9</code>: dimensions, e.g. 42 landmarks (K), 3 dimensions (D), 9 specimens (n).</p>
<p>- Landmark names, separated by space.</p>
<p>- The stacked data of landmark coordinates, e.g. 3 columns,
space separated numeric values with K*n rows,
the K landmarks per individuals stacked n times.</p>
<p>- Blank line.</p>
<p>- Date on of scans for each specimen (n rows),
this part is also used to get specimen IDs.</p>
<p>After reading in or simulating and EDMA data object,
the methods help extracting info, or manipulate these objects.
See Values and Examples.</p>
<p>The EDMA data object (class 'edma_data') is a list with two
elements: <code>$name</code> is the data set name (header information from
the .xyz file), <code>$data</code> is a list of n matrices (the list can be
named if speciemen information is present),
each matrix is of dimension K x D, dimension names for the
matrices describing landmark names and coordinate names.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>edma_simulate_data</code> returns an EDMA data object of
class 'edma_data'.</p>
<p>The <code>dim</code> returns the number of landmarks (K), dimensions (D),
and specimens (n) in a data object.</p>
<p><code>landmarks</code>, <code>dimensions</code>, and <code>specimens</code>
are dimensions names, <code>dimnames</code> returns these as a list.
Landmark names and dimensions are used to check
if landmarks are homogeneous among objects.
It is possible to set the dimansion names as
<code>dimnames(x) &lt;- value</code> where <code>value</code> is the
new value for the name.</p>
<p>The <code>print</code> method prints info about the data object.</p>
<p>The methods <code>stack</code> and <code>as.matrix</code> return a stacked
2D array (K*n x D) with the landmark coordinates,
<code>as.data.frame</code> turns the same 2D stacked array into a data frame,
<code>as.array</code> returns a 3D array (K x D x n).
<code>as.edma_data</code> turns a 3D array to an EDMA data object,
this is useful to handle 3D array objects returned by many
functions of the geomorph package (i.e. after reding
Morphologika, NTS, TPS files).</p>
<p><code>combine_data</code> and <code>combine_data4</code> combines
2 or 4 EDMA data sets together, landmarks must be homologous.</p>
<p><code>as.dist</code> calculates the dissimilarity matrix (n x n, object
of class 'dist', see <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code>) containing
pairwise dissimilarities among the specimens.
Dissimilarity is based on the T-statistic (max/min distance)
averaged (so that it is symmetric) and on the log scale
(so that self dissimilarity is 0).</p>
<p><code>subset</code> and <code>[i,j,k]</code> returns an EDMA data object
with the desired dimensions or permutations. See Examples.</p>
<p><code>plot</code> and <code>plot_2d</code> produces a series of plots
as a side effect, returning the data object invisibly.
The functions provide diagnostics for each specimen
or just the specimen selected by the <code>which</code> argument.
The 2D projection is used in case of 3D landmark data.
The convex hull of the specimens (excluding the one being
selected) is compared with the actual specimen's landmarks.
This allows easy spotting of erroneous data.</p>
<p>The <code>plot_ord</code> and <code>plot_clust</code> are based on the
dissimilarities among specimens and provide ordination
(metric multidimensional scaling using <code><a href='https://rdrr.io/r/stats/cmdscale.html'>cmdscale</a></code>
based on square rooted dissimilarities and Cailliez's correction).
and hierarchical cluster dendrogram (using the <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code>
function with Ward's clustering method).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Peter Solymos</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>plot.edma_data</code> for visualizing EDMA data objects.</p>
<p><code><a href='edma_fit.html'>edma_fit</a></code> for EDMA analysis.</p>
<p><code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code> for dissimilarity matrices and
<code><a href='edma_fdm.html'>T_test</a></code> for description of the T-statistic.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## read xyz files</span>
<span class='va'>file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
    <span class='st'>"extdata/crouzon/Crouzon_P0_Global_MUT.xyz"</span>,
    package<span class='op'>=</span><span class='st'>"EDMAinR"</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'>read_xyz</span><span class='op'>(</span><span class='va'>file</span><span class='op'>)</span>
<span class='va'>x</span>
</div><div class='output co'>#&gt; EDMA data: Crouzon P0 MUT
#&gt; 47 landmarks, 3 dimensions, 28 specimens</div><div class='input'>
<span class='co'>## test writing xyz file</span>
<span class='va'>f</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span>fileext <span class='op'>=</span> <span class='st'>".xyz"</span><span class='op'>)</span>
<span class='fu'>write_xyz</span><span class='op'>(</span><span class='va'>x</span>, file<span class='op'>=</span><span class='va'>f</span><span class='op'>)</span>
<span class='va'>tmp</span> <span class='op'>&lt;-</span> <span class='fu'>read_xyz</span><span class='op'>(</span>file<span class='op'>=</span><span class='va'>f</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/stopifnot.html'>stopifnot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/identical.html'>identical</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/unlink.html'>unlink</a></span><span class='op'>(</span><span class='va'>f</span><span class='op'>)</span>

<span class='co'>## the orignal structure</span>
<span class='va'>l</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='va'>file</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='va'>l</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>]</span>, sep<span class='op'>=</span><span class='st'>"\n"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Crouzon P0 MUT
#&gt; XYZ
#&gt; 47L 3 28 
#&gt; amsph bas cpsh ethma ethmp laalf lasph lflac lnsla lnslp locc loci lpalf lpfl lpmx lpns lpsh lpsq lpto lptyp lsqu lsyn lzya lzygo lzyt opi raalf rasph rflac rmaxi rnsla rnslp rocc roci rpalf rpfl rpmx rpns rpsh rpsq rpto rptyp rsqu rsyn rzya rzygo rzyt 
#&gt; 5.85485 5.98171 2.2017
#&gt; 2.79418 6.2371 0.400282
#&gt; 6.85584 5.80958 3.3537
#&gt; 9.10866 5.82195 3.91282
#&gt; 8.2508 5.81294 3.77622
#&gt; 10.0935 6.17677 3.65059</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='va'>l</span><span class='op'>[</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>l</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>l</span><span class='op'>)</span><span class='op'>]</span>, sep<span class='op'>=</span><span class='st'>"\n"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; CZCD1_37 Scanned on 010511
#&gt; CZCD1_39 Scanned on 010511
#&gt; CZCD1_40 Scanned on 010511
#&gt; CZCD1_42 Scanned on 010511
#&gt; CZCD1_53 Scanned on 122310
#&gt; CZCD1_56 Scanned on 122310
#&gt; CZCD1_59 Scanned on 122310
#&gt; CZCD1_65 Scanned on 010511
#&gt; CZCD1_66 Scanned on 010511
#&gt; CZCD1_72 Scanned on 010311
#&gt; CZCD1_73 Scanned on 010311</div><div class='input'>
<span class='co'>## plots</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>,,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span> <span class='co'># steps through all individuals</span>
</div><div class='img'><img src='edma_data-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='edma_data-2.png' alt='' width='700' height='433' /></div><div class='img'><img src='edma_data-3.png' alt='' width='700' height='433' /></div><div class='img'><img src='edma_data-4.png' alt='' width='700' height='433' /></div><div class='img'><img src='edma_data-5.png' alt='' width='700' height='433' /></div><div class='img'><img src='edma_data-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plot_2d</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='co'># all speciemns in 1 plot</span>
</div><div class='input'><span class='fu'>plot_2d</span><span class='op'>(</span><span class='va'>x</span>, which<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='co'># show specimen #2</span>
</div><div class='img'><img src='edma_data-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plot_ord</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='img'><img src='edma_data-8.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plot_clust</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='img'><img src='edma_data-9.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## dimensions and names</span>
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 47  3 28</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [[1]]
#&gt;  [1] "amsph" "bas"   "cpsh"  "ethma" "ethmp" "laalf" "lasph" "lflac" "lnsla"
#&gt; [10] "lnslp" "locc"  "loci"  "lpalf" "lpfl"  "lpmx"  "lpns"  "lpsh"  "lpsq" 
#&gt; [19] "lpto"  "lptyp" "lsqu"  "lsyn"  "lzya"  "lzygo" "lzyt"  "opi"   "raalf"
#&gt; [28] "rasph" "rflac" "rmaxi" "rnsla" "rnslp" "rocc"  "roci"  "rpalf" "rpfl" 
#&gt; [37] "rpmx"  "rpns"  "rpsh"  "rpsq"  "rpto"  "rptyp" "rsqu"  "rsyn"  "rzya" 
#&gt; [46] "rzygo" "rzyt" 
#&gt; 
#&gt; [[2]]
#&gt; [1] "X" "Y" "Z"
#&gt; 
#&gt; [[3]]
#&gt;  [1] "CZCD1_1"  "CZCD1_2"  "CZCD1_7"  "CZCD1_10" "CZCD1_11" "CZCD1_15"
#&gt;  [7] "CZCD1_16" "CZCD1_18" "CZCD1_20" "CZCD1_21" "CZCD1_23" "CZCD1_24"
#&gt; [13] "CZCD1_25" "CZCD1_28" "CZCD1_30" "CZCD1_32" "CZCD1_36" "CZCD1_37"
#&gt; [19] "CZCD1_39" "CZCD1_40" "CZCD1_42" "CZCD1_53" "CZCD1_56" "CZCD1_59"
#&gt; [25] "CZCD1_65" "CZCD1_66" "CZCD1_72" "CZCD1_73"
#&gt; </div><div class='input'><span class='fu'>landmarks</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "amsph" "bas"   "cpsh"  "ethma" "ethmp" "laalf" "lasph" "lflac" "lnsla"
#&gt; [10] "lnslp" "locc"  "loci"  "lpalf" "lpfl"  "lpmx"  "lpns"  "lpsh"  "lpsq" 
#&gt; [19] "lpto"  "lptyp" "lsqu"  "lsyn"  "lzya"  "lzygo" "lzyt"  "opi"   "raalf"
#&gt; [28] "rasph" "rflac" "rmaxi" "rnsla" "rnslp" "rocc"  "roci"  "rpalf" "rpfl" 
#&gt; [37] "rpmx"  "rpns"  "rpsh"  "rpsq"  "rpto"  "rptyp" "rsqu"  "rsyn"  "rzya" 
#&gt; [46] "rzygo" "rzyt" </div><div class='input'><span class='fu'>specimens</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "CZCD1_1"  "CZCD1_2"  "CZCD1_7"  "CZCD1_10" "CZCD1_11" "CZCD1_15"
#&gt;  [7] "CZCD1_16" "CZCD1_18" "CZCD1_20" "CZCD1_21" "CZCD1_23" "CZCD1_24"
#&gt; [13] "CZCD1_25" "CZCD1_28" "CZCD1_30" "CZCD1_32" "CZCD1_36" "CZCD1_37"
#&gt; [19] "CZCD1_39" "CZCD1_40" "CZCD1_42" "CZCD1_53" "CZCD1_56" "CZCD1_59"
#&gt; [25] "CZCD1_65" "CZCD1_66" "CZCD1_72" "CZCD1_73"</div><div class='input'><span class='fu'>dimensions</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "X" "Y" "Z"</div><div class='input'>
<span class='co'>## subsets</span>
<span class='va'>x</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span>
</div><div class='output co'>#&gt; EDMA data: Crouzon P0 MUT
#&gt; 10 landmarks, 2 dimensions, 5 specimens</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; EDMA data: Crouzon P0 MUT
#&gt; 47 landmarks, 3 dimensions, 10 specimens</div><div class='input'>
<span class='co'>## coercion</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  num [1:1316, 1:3] 5.85 2.79 6.86 9.11 8.25 ...
#&gt;  - attr(*, "dimnames")=List of 2
#&gt;   ..$ : chr [1:1316] "CZCD1_1_amsph" "CZCD1_1_bas" "CZCD1_1_cpsh" "CZCD1_1_ethma" ...
#&gt;   ..$ : chr [1:3] "X" "Y" "Z"</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 'data.frame':	1316 obs. of  3 variables:
#&gt;  $ X: num  5.85 2.79 6.86 9.11 8.25 ...
#&gt;  $ Y: num  5.98 6.24 5.81 5.82 5.81 ...
#&gt;  $ Z: num  2.2 0.4 3.35 3.91 3.78 ...</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/stack.html'>stack</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  num [1:1316, 1:3] 5.85 2.79 6.86 9.11 8.25 ...
#&gt;  - attr(*, "dimnames")=List of 2
#&gt;   ..$ : chr [1:1316] "CZCD1_1_amsph" "CZCD1_1_bas" "CZCD1_1_cpsh" "CZCD1_1_ethma" ...
#&gt;   ..$ : chr [1:3] "X" "Y" "Z"</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/array.html'>as.array</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  num [1:47, 1:3, 1:28] 5.85 2.79 6.86 9.11 8.25 ...
#&gt;  - attr(*, "dimnames")=List of 3
#&gt;   ..$ : chr [1:47] "amsph" "bas" "cpsh" "ethma" ...
#&gt;   ..$ : chr [1:3] "X" "Y" "Z"
#&gt;   ..$ : chr [1:28] "CZCD1_1" "CZCD1_2" "CZCD1_7" "CZCD1_10" ...</div><div class='input'><span class='fu'>as.edma_data</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/array.html'>as.array</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; EDMA data: Landmark data
#&gt; 47 landmarks, 3 dimensions, 28 specimens</div><div class='input'>
<span class='co'>## simulate data</span>
<span class='va'>K</span> <span class='op'>&lt;-</span> <span class='fl'>3</span> <span class='co'># number of landmarks</span>
<span class='va'>D</span> <span class='op'>&lt;-</span> <span class='fl'>2</span> <span class='co'># dimension, 2 or 3</span>
<span class='va'>sig</span> <span class='op'>&lt;-</span> <span class='fl'>0.75</span>
<span class='va'>rho</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>SigmaK</span> <span class='op'>&lt;-</span> <span class='va'>sig</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>K</span>, <span class='va'>K</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>sig</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>rho</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>K</span>, <span class='va'>K</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>M</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>, <span class='fl'>3</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>M</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>M</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>M</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>M</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>M</span> <span class='op'>&lt;-</span> <span class='fl'>10</span><span class='op'>*</span><span class='va'>M</span>

<span class='fu'>edma_simulate_data</span><span class='op'>(</span><span class='fl'>10</span>, <span class='va'>M</span>, <span class='va'>SigmaK</span><span class='op'>)</span>
</div><div class='output co'>#&gt; EDMA data: Simulated landmark data
#&gt; 3 landmarks, 2 dimensions, 10 specimens</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Peter Solymos, Subhash R. Lele, Theodore M. Cole, Liangyuan Hu, Joan T. Richtsmeier.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


